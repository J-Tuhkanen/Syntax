@page
@using Syntax.Core.Services.Interfaces;
@inject ApplicationDbContext AppDBContext
@inject IUserService userService;

@model IndexModel

@section Styles {
    <link href="@Url.Content("~/css/site.css")" rel="stylesheet" type="text/css" />
    <link href="@Url.Content("~/css/post.css")" rel="stylesheet" type="text/css" />
}

@section Scripts {
    <script src="~/js/index.js"></script>
}

<div>
    
    @foreach(var post in Model.Posts)
    {
        var postUrl = @Url.Page("post", new { id = post.Model.Id });
        var postAuthor = await userService.GetUserAccountAsync(post.Model.UserId);

        <div class="main-page-post" data-view-post-url="@postUrl">
            <div class="post-content">
                <div class="post-sub-container header-container">
                    <h3>@post.Model.Title</h3>
                </div>
                <div class="post-sub-container">
                    <p class="post-body">@post.DisplayBody</p>
                </div>
                     
                <div class="post-sub-container author-container">
                    <a class="post-author" href="@Url.Page("profile", new { id = post.Model.UserId })">@postAuthor.UserName</a>
                </div>
            </div>
        </div>
    }

</div>
